singularity-selinux audit # grep denied audit.log | grep openstack | audit2allow


#============= initrc_t ==============
allow initrc_t openstack_guest_agent_t:process { siginh rlimitinh noatsecure };

#============= openstack_guest_agent_t ==============
allow openstack_guest_agent_t chkpwd_exec_t:file { read execute open execute_no_trans };
allow openstack_guest_agent_t console_device_t:chr_file read;
allow openstack_guest_agent_t crack_db_t:file { read getattr open };
allow openstack_guest_agent_t etc_runtime_t:dir search;
allow openstack_guest_agent_t etc_runtime_t:file { read getattr open };
allow openstack_guest_agent_t init_t:fd use;
allow openstack_guest_agent_t locale_t:file { read getattr open };
allow openstack_guest_agent_t nscd_exec_t:file { read execute open execute_no_trans };
allow openstack_guest_agent_t security_t:dir { read getattr open search };
#!!!! The source type 'openstack_guest_agent_t' can write to a 'file' of the following types:
# net_conf_t, openstack_guest_agent_var_cache_t, openstack_guest_agent_var_run_t, etc_t, xenfs_t

allow openstack_guest_agent_t security_t:file { read write getattr open };
allow openstack_guest_agent_t security_t:filesystem getattr;
allow openstack_guest_agent_t security_t:security compute_av;
allow openstack_guest_agent_t self:process setfscreate;
#!!!! The source type 'openstack_guest_agent_t' can write to a 'file' of the following types:
# net_conf_t, openstack_guest_agent_var_cache_t, openstack_guest_agent_var_run_t, etc_t

allow openstack_guest_agent_t shadow_t:file { rename setattr read create write getattr unlink open };
#!!!! The source type 'openstack_guest_agent_t' can write to a 'dir' of the following types:
# openstack_guest_agent_var_cache_t, openstack_guest_agent_var_run_t, var_run_t, etc_t

allow openstack_guest_agent_t tmp_t:dir { write remove_name add_name };
#!!!! The source type 'openstack_guest_agent_t' can write to a 'file' of the following types:
# net_conf_t, openstack_guest_agent_var_cache_t, openstack_guest_agent_var_run_t, etc_t

allow openstack_guest_agent_t tmp_t:file { write getattr read create unlink open };
allow openstack_guest_agent_t usr_t:file { read getattr open };
